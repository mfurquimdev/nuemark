import{onclick as H,loadPage as I,setSelected as J} from"./page-router.js";async function E(R){for(let{pattern:q,fn:u}of z){const w=F(q,R);if(w)await u(w)}J(R)}function F(R,q,u){const w=R.split("/").slice(1),B=q.split("/").slice(1);if(!u&&w.length!=B.length)return null;let C=!0;const D={};return w.forEach((A,G)=>{const x=B[G];if(A[0]==":"){if(x)D[A.slice(1)]=1*x||x}else if(!u&&A!=x)C=!1}),C?D:null}var z=[];addEventListener("before:route",()=>{z.splice(0,z.length)});var K={on(R,q){z.push({pattern:R,fn:q})},start({path:R,root:q}){if(q)H(q,this.route);this.pattern=R,E(location.pathname)},route(R){scrollTo(0,0);const q=R.endsWith(".html");history.pushState({path:R,is_spa:!q},0,R),q?I(R):E(R)},set(R,q){const u=new URLSearchParams(location.search);u.set(R,q),history.replaceState(K.data,0,`?${u}`)},get data(){const{pattern:R}=this,q=R?F(R,location.pathname,!0):{},u=Object.fromEntries(new URLSearchParams(location.search));return{...q,...u}}};export{K as router,F as match};
